{
  "description": "Example Mapping for security-sensitive password reset feature",
  "inputs": {
    "userStory": "As a user, I want to reset my password via email, so that I can regain access to my account if I forget my password",
    "timeboxMinutes": 25,
    "sessionMode": "collaborative",
    "existingContext": {
      "existingFeatures": ["email service", "user authentication", "password hashing"],
      "securityPolicies": [
        "Password complexity: min 8 chars, uppercase, lowercase, number, special char",
        "Reset tokens expire after 1 hour",
        "Rate limiting: max 3 reset requests per hour per email",
        "Audit logging required for security events"
      ],
      "integrations": ["email service API", "logging service"],
      "regulations": ["GDPR", "SOC2"]
    },
    "stakeholders": [
      { "role": "product-owner", "name": "Alice" },
      { "role": "security-lead", "name": "Bob" },
      { "role": "backend-developer", "name": "Charlie" },
      { "role": "qa-engineer", "name": "Diana" }
    ]
  },
  "expectedOutputs": {
    "rules": [
      "User enters email address on reset page",
      "System sends reset link to email if account exists",
      "System sends same 'check email' message even if account doesn't exist (security)",
      "Reset link contains time-limited token (1 hour)",
      "Token can only be used once",
      "New password must meet complexity requirements",
      "Rate limiting prevents abuse (3 requests per hour per email)",
      "Successful reset invalidates all existing sessions",
      "Reset link expires show helpful error"
    ],
    "exampleScenarios": [
      "User with valid email requests reset → receives email with link",
      "User with invalid email requests reset → receives generic 'check email' message",
      "User clicks valid reset link → shown password entry form",
      "User clicks expired reset link → error shown with option to request new link",
      "User tries to reuse reset link → error shown",
      "User submits weak password → validation errors shown",
      "User submits valid password → success, logged in, old sessions invalidated",
      "User makes 4 reset requests in 1 hour → 4th request blocked with rate limit message"
    ],
    "questions": [
      "Should we allow password reset for locked accounts?",
      "What's the user experience if email service is down?",
      "Do we notify users when password is changed from another device?",
      "Should reset invalidate 2FA/MFA settings?",
      "What happens to pending reset tokens when user successfully resets?"
    ],
    "securityConsiderations": [
      "No email enumeration (don't reveal if account exists)",
      "Token should be cryptographically secure random",
      "HTTPS only for reset pages",
      "Log all reset attempts for audit",
      "Consider adding CAPTCHA to prevent automated abuse"
    ],
    "readiness": "ready after security lead answers questions"
  }
}
